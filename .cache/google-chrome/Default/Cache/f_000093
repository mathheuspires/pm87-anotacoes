(function(n){function o(){}function li(){function bi(){return u&&u.me.authenticated()}function sr(){ot=!0}function hr(){lr(),ot=!1,w!=null&&(t.clearInterval(w),t.setTimeout(function(){s.title=tt},200),hi=0,ci={},w=null)}function ai(n){return e.SwxShim.imgBase+n}function gr(n){var r=ai("webim/toast-buttons.png"),i=" style=\"background-image:url('"+r+"')\" ",u='<div id="swx-call-toast"><div id="swx-call-toast-info" class="toast-info" tabindex="-1" role="region"><strong id="callerName">'+n.encodeHtml()+"<\/strong><p>"+v("incomingcall")+'<\/p><\/div><div class="toast-callControls"><ul><li><a href="#" role="button" class="toast-videoCallBtn" id="toast-videoCallBtn"'+i+">"+v("videocall")+'<\/a><\/li><li><a href="#" role="button" class="toast-audioCallBtn" id="toast-audioCallBtn"'+i+">"+v("voicecall")+'<\/a><\/li><li><a href="#" role="button" class="toast-endCallBtn" id="toast-endCallBtn"'+i+">"+v("declinecall")+"<\/a><\/li><\/ul><\/div><\/div>";return t.wLive.Controls.Notifications.createToast({title:"",content:u,sourceIcon:ai(ei),options:{backgroundColor:"#00AFF0",timeout:"Long",dismissOnInsideClick:!1,priority:"Normal",moreCss:"SwxToast"}})}function di(i,r){var u=n("<div class='imToastBody' />").text(r),f=i?n("<div class='imToastHeader' />").text(i):"";return t.wLive.Controls.Notifications.createToast({title:f,content:u,sourceIcon:ai(fi),options:{moreCss:"t_cbr"}})}function nu(t,r){var u,e=!1,f=t.displayName(),o,s;switch(r.type){case a.ContactRequest:u=di(f,v("addcontact").format(f));break;case a.Chat:u=di(f,r.description());break;case a.UnreadMessage:i.isSidebarOpened()||(u=di(f,r.description()));break;case a.Audio:case a.Video:u=gr(f),e=!0;break;case a.NoPlugin:default:u=null}if(u){cr(t.uri()),b[t.uri()]=u,o=function(n){u.dismiss(),i.showSidebar(),r.accept(n)};n(u).on("aftershow",function(){r.sound.play(),n("#toast-endCallBtn").click(function(){return u.dismiss(),r.decline(),!1}),n("#toast-audioCallBtn").click(function(){return o(p.Audio),!1}),n("#toast-videoCallBtn").click(function(){return o(p.Video),!1})}).on("afterdismiss",function(){r.sound.stop()});e&&(s=r.active.subscribe(function(n){n||(u.dismiss(),s.dispose())})),u.show().then(function(n){n.clicked&&!e&&(i.showSidebar(),r.open())})}}function cr(n){if(b[n])try{b[n].dismiss();var i=t.wLive.Controls.Notifications.getQueue();i&&i.removeNotification(b[n])}catch(r){l.logError("removeToastFromQueueError",r)}}function tu(t){var i,r,u;t!==st&&(st=t,i=t>99?"99+":t>0?t:"",r=n("#c_ofm"),u=r.parent(),r.html(i),n("#c_hiconm").width(u.width()+"px"),lr())}function lr(){st>0&&y.Animations.enterContent(n("#c_ofm"),{top:100,left:0}).then()}function gi(n,t){var i=n.getPreferredSkypeContactUri();ar(i,t)}function ar(n,r){yt.done(function(){var f=t.$header;f.showLoading(),i.showSidebar(!0),u.startConversation([n],[r],function(){f.hideLoading()},function(){f.hideLoading();var i=t.wLive.Controls.Notifications.createTopBar({content:v("startconversationerror"),dismissalMode:t.wLive.Controls.Notifications.BarDismissalMode.Timeout});i.show()})})}function iu(){var t=40;return n("#m_wh").length>0?t=n("#m_wh").height():n("#HeaderContainer").length>0&&(t=n("#HeaderContainer").height()),t}function vr(){var i,t;ht=!1,i=vt("c_hiconm"),i!=null&&i.setAttribute("aria-pressed","false"),t=n("#sidebar"),t.is(":hidden")||(pt("onSidebarClosedEvent",null),y.Animations.hideEdgeUI(t,{left:nt,top:0}).then(function(){c.rtl&&n(t).css("left",""),t.hide(),pt("onSidebarCloseCompletedEvent",null),n(i).css("background-color","")})),ru(oi)}function pt(t,i){n("#sidebar").trigger(t,i)}function ru(n){var t="cid="+e.cid+":state="+n;at.setCookie("Webim_Sidebar_Open",t,e.sd,0,null,1)}function uu(){lt.fetchScript(ct.ScriptUri,yr),lt.fetchScript(ct.Str,function(){fr.resolve()})}function yr(){var n,i;yt.notify("boot"),n=t.Skype,n&&(i={apiKey:ct.ApiKey,locale:ct.Locale,correlationIds:{userId:ct.SwxUserId}},n.initialize(i,eu,su))}function fu(){var n="<a target='_blank' href='"+e.SwxShim.TermsOfUseUrl.format(ct.Locale).encodeHtmlAttribute()+"' > "+g("TermsOfUse")+"<\/a>",i="<a target='_blank' href= '"+e.SwxShim.PrivacyPolicyUrl.format(ct.Locale).encodeHtmlAttribute()+"' > "+g("PrivacyPolicy")+"<\/a>",r="<div> <img class='swxAccountLinkingImage' src='"+ai("webim/swxAccountLinking.png")+"'/><div class='swxAccountLinkingText'> <p>"+g("Text1")+"<\/p><p>"+g("Text2").format(n,i)+"<\/p><\/div><\/div>";return t.wLive.Controls.Notifications.createModalDialog({title:g("Title"),content:r,notificationArea:"<p  class='swxAccountLinkingSignUp'> "+g("Text3")+"<a href='#' role='button' id='swxSignInBtn'> "+g("SignIn")+"<\/a> <\/p>",buttons:{action:g("Continue")},options:{dismissOnEsc:!1}})}function eu(t){u=t,li.push(u.me.authenticated.subscribe(au)),u.setAuthProvider({type:"implicitOAuth"},ou,function(r){if(e.SwxShim.SwxAccountLinking&&r.reason=="not-linked"){modal=fu();n(modal).on("aftershow",function(){n(i).trigger("showedUnlinkedInterstitial"),n("#swxSignInBtn").click(function(){return modal.dismiss(),i.showSidebar(),t.setAuthProvider({type:"implicitOAuth",flow:"inlineSignIn"}),!1})});modal.show().then(function(n){n.buttonClicked==="action"&&(i.showSidebar(),t.setAuthProvider({type:"implicitOAuth",flow:"inlineNewUser"}))})}ir(3,"Authentication failed.")}),u.setNotificationHandler(cu),u.subscribeUI("swx:callscreen:maximize",hu),li.push(u.activity.unreadConversations.subscribe(vu)),n("#sidebar").length==0&&(yi(),wu(),n("#c_hiconm").removeClass("c_md")),h.register("wlximuiouter",0,!0),yt.resolve()}function ou(){}function su(n){ir(1,"Failed to initialize Skype API: "+n),yt.reject(n)}function hu(t){n("#sidebar").toggleClass("swxIsFullscreen",t)}function cu(n){lu(n),nu(n.sender,n)}function lu(n){fr.done(function(){if(ot&&n.type===a.UnreadMessage&&n.sender!==u.me&&n.active()){var t=u.activity.unreadConversations();t>1?ki(v("newmultiplemessagenotification").format(t).trim()):ki(v("newmessagenotification").format(n.sender.displayName()).trim())}})}function au(n){n?(ri=!0,wi||setTimeout(function(){h.when("$pwc",0,function(){pu(),h.register("$WLXIM.UserSignedIn"),l.logAction("WebIM_SignedIn")})},0)):ri&&(ri=!1,ir(2,"Authentication failed or you are disconnected from UCWA")),tr()}function vu(n){tu(n)}function yu(){var i=n("#sidebar"),t=n('<div class="sidebarContainer"><\/div>');i.append(t),t.append(n('<div class="skype-Content o365-flexPane-skype-content"><\/div>')),t.append(n('<div class="skype-Sidebar o365-flexPane-skype-sidebar"><\/div>')),u.renderContent(".skype-Content"),u.renderSidebar(".skype-Sidebar")}function pu(){var r,i,u,n;if(!wi){for(r=t.$pwc,i=r.getPersons({isIMCapable:!0,networks:[d,k,ft]}),n=0;n<i.length;n++)u=i[n],pr(u);wi=!0}}function pr(n){var i,r,h,c,f;if(!n)return null;var p=n.getContacts(),l=n.getMessagingAddresses(),e=[],o=n.isMe(),t=null,s;for(i=0;i<l.length;i++){var a=l[i],v=a._getContact(),y=v.getSourceId();s=o?"self":ni(v),s&&(r=null,o?r=u.me:(y==d||y==k)&&(r=u.contact(s)),h=new ti(a,r),e.push(h),li.push(h))}if(e.length>0){for(t=new ii(n,e),c=t.getCids(),f=0;f<c.length;f++)er[c[f]]=t;o&&(or=t)}return t}function wu(){n(window).bind("unload",wr),n(window).bind("resize",br),n(window).bind("blur",sr),n(window).bind("focus",hr)}function wr(){n(window).unbind("unload",wr),n(window).unbind("resize",br),n(window).unbind("blur",sr),n(window).unbind("focus",hr),gt(li)}function br(){if(f&&f.length>0&&i.isSidebarOpened()&&!i.isSidebarOverlay()){var t=n(window).width()-nt+"px";try{f.width(t)}catch(r){}}}function tr(){for(var t=0,r=pi.clone(),u=r.length;t<u;t++)try{r[t]()}catch(f){l.logError("WebIM_InformStateChagne",f)}n(i).trigger("stateChange")}function ir(n,t){ur=1,tr(),l.log({eventType:"WebIM_InitializationFailure",resultCode:n,resultDetails:{message:t}})}function v(n){var i="";return t.GetString&&(i=t.GetString("live.shared.strings.swxshim."+n)),i}function g(n){var i="";return t.GetString&&(i=t.GetString("live.shared.strings.SkypeAccountLinking."+n)),i}var i=this,vi,bu="pres",ku="=",rr,ct=e.SwxShim,u,pi=[],du,kr,gu,nf,tf=5,rf=0,uf,ur,ff,ef,of,ri,sf,hf,cf="",lf,af,dr,yt=n.Deferred(),fr=n.Deferred(),li=[],wi=!1,er={},or,ki,nr;i.isOff=function(){return!1},i.isUnsupported=function(){return!1},i.isError=function(){return!i.isOff()&&ur},i.isLoading=function(){return!i.isOff()&&!i.isError()&&!u},i.isWaitingToReconnect=function(){return!1},i.hasContacts=function(){return ri},i.hasNotify=function(){return bi()},i.hasPresence=function(){return bi()},i.isFull=function(){return bi()},i.addScenarioQoSStats=function(n,t,i,r,u){if(r){var f={api:n,dependent:si};typeof t!="undefined"&&t!=null&&(f.error=t),u&&(f.errorType="c"),y.ScenarioQoSStats.add(f,i,r),l.log({eventType:n,resultCode:t})}},i.addStateListener=function(n){pi.push(n)},i.removeStateListener=function(n){var t=pi.remove(n)},i.toggleSidebar=function(t){var f=!t||t.type=="mousedown"||t.which==13,r,u;f&&(r=n("#sidebar"),r.length>0&&(r.is(":hidden")?(i.showSidebar(!0),t&&t.which==13&&(u=r.find("a"),u.length>0&&u[0].focus())):(dt("header"),vr(),pt("landingPageControlVisible",!1))))},i.dismissSidebar=function(){dt("closeButton"),vr()},i.removeAllToasts=function(){for(var n in b)cr(n)},ki=function(){var n=!1,i=function(){n?(s.title=it,n=!1):s.title==it?s.title=tt:(tt=s.title,s.title=it)};return function(r){n=!0,it=r,w==null&&(tt=s.title,w=t.setInterval(i,1e3))}}(),i.isSidebarOpened=function(){return ht},i.isSidebarOverlay=function(){return rt&&n(window).width()<et},i.setPaneToResize=function(n){f=n,$WLXIM.isSidebarOpened()&&kt(null,i.isSidebarOverlay())},i.resetSidebarOverlaySettings=function(){rt=!1,et=bt},i.setSidebarOverlay=function(n){rt=n},i.setSidebarOverlayWindowWidth=function(n){rt=!0,et=n},i.setSidebarToFullScreen=function(t){ut=t==!0?"0px":iu()+"px",n("#sidebar").css("top",ut)},i.pause=o,i.resume=o,i.setTestFlags=o,i.getTestFlags=o,i.signIn=o,i.signOut=o,i.reconnect=o,i.registerWacChat=o,i.showFlyout=o,i.startConversationWithContactId=o,i.startConversationWithContact=o,i.startConversationWithIMAddress=o,i.startConversation=function(n){gi(n,p.Chat)},i.startAudioCall=function(n){return gi(n,p.Audio),!0},i.startVideoCall=function(n){return gi(n,p.Video),!0},i.switchPresence=function(n){var t=r[n];u&&t&&u.me.status(t)},i.getPresence=function(){var n=wt.PresenceStatus.offline;return u&&(n=r[u.me.status()]||n),n},i.isVVWindow=function(){return!1},nr=!1,i.showSidebar=function(){var u=vt("c_hiconm"),r;u!=null&&u.setAttribute("aria-pressed","true"),r=n("#sidebar"),r.is(":hidden")&&(r.show(),pt("onSidebarOpenedEvent",i.isSidebarOverlay()),r.css(c.rtl?"left":"right","0"),y.Animations.showEdgeUI(r,{left:n(window).width(),top:0}).then(function(){if(pt("onSidebarOpenCompletedEvent",i.isSidebarOverlay()),c.IE_M7&&f&&f.length>0){var t=f.get(0),r=t.style.display;t.style.display="none",t.style.display=r}n(u).css("background-color",ui)})),nr||(yu(),nr=!0),ht=!0},i.getSidebarOpenCookieState=function(){var t=at.getCookie("Webim_Sidebar_Open"),n;return t&&(n=t.split(":state="),n&&n.length==2&&n[0].endsWith(e.cid)&&n[1].length>0)?n[1]:null},i.init=function(n,i){dr=i,u||(kr=1,l.logAction("WebIM_DownloadingResources"),tr(),yt.notify("init"),rr||(rr=e.WebIM),t.Skype?yr():uu())},i.user=vi={},vi.get_contact=function(){return or},vi.findContactById=function(n){var i=er[n];return!i&&t.$pwc&&(i=pr(t.$pwc.getPerson(n))),i}}function ai(){e.SwxShim&&e.SwxShim.ScriptUri&&(t.$WLXIM=new li,h.when("$BSI",0,wi))}function kt(t,i){var r,u;f&&f.length>0&&!i&&(c.rtl&&c.Firefox&&(r=nt+f.width()-n(window).width(),f.css("left",r+"px")),u=n(window).width()-nt+"px",f.width(u))}function vi(){f&&f.length>0&&(f.width(""),c.rtl&&c.Firefox&&f.css("left","0"))}function yi(){var i=pi(ri,s.body,"sidebar",null),r=n(i);i.setAttribute("persist","1"),$WLXIM.sidebar=i,h.register("$WLXIM.SidebarCreated"),r.bind("onSidebarOpenedEvent",kt),r.bind("onSidebarCloseCompletedEvent",vi),r.addClass("t_sbgc swxShimSidebar"),h.register("wlxim_startconversation",$WLXIM.startConversationWithContact),h.when("NotificationControls",0,function(){t.wLive.Controls.Notifications.getQueue().start()}),r.css("top",ut),t.$Sutra&&t.$Sutra.WebIM&&sutra(i,"$Sutra.WebIM.WebIMSidebar")}function pi(n,t,i,r){var u=s.createElement(n);return r&&(u.innerHTML=r),i&&(u.id=i,u.className=i),t&&t.appendChild(u),u}function wi(){var i=$WLXIM,t;e.WebIM.f||i.init(),h.register("wlxim",0,!0),n(".App #BelowHeader").length>0?$WLXIM.setPaneToResize(n(".App #BelowHeader")):(t=n("#c_base"),t.length>0&&$WLXIM.setPaneToResize(t)),n("#c_header").length==0?$WLXIM.setSidebarToFullScreen(!0):$WLXIM.setSidebarToFullScreen(!1)}function dt(n){var i={WebIMCloseLocation:n};t.$BSI.reportEvent("WebIM.SidebarHidden",{WebIMCloseLocation:n}),l.logDetails("WebIM_SidebarHidden",i)}function gt(n){for(var t=0;t<n.length;t++)n[t].dispose&&n[t].dispose()}function ni(n){var t=n.getSourceId();switch(t){case ft:return n.getSkypeId();case k:return n.getPassportMemberName();case d:default:return n.getObjectId()}}function ti(n,t){var i=this,r=n._getContact();i._subscriptions=[],i._addr=n,i._skype=t,i._uri=ni(r),i._sourceId=r.getSourceId(),t?i._subscribe():i._updateMessagingAddress(u.offline)}function ii(n,t){var i=this;i._person=n,i._contacts=t}var t=window,y=t.wLive,c=t.$B,lt=t.$Network,at=t.$Cookie,e=t.$Config,h=t.$Do,l=y.People.Reporter,s=t.document,vt=t._ge,yt=t.Microsoft=t.Microsoft||{},pt=yt.Live=yt.Live||{},wt=pt.Messenger=pt.Messenger||{},u=wt.PresenceStatus={offline:0,online:1,appearOffline:2,busy:3,idle:4,beRightBack:5,away:6,inACall:7,outToLunch:8},i={Unknown:"Unknown",Online:"Online",Offline:"Offline",Hidden:"Hidden",Busy:"Busy",Idle:"Idle",BeRightBack:"BeRightBack",Away:"Away",DoNotDisturb:"DoNotDisturb"},a={Chat:"Chat",Audio:"Audio",Video:"Video",NoPlugin:"incomingCallWithNoPlugin",UnreadMessage:"UnreadMessage",ContactRequest:"ContactRequest"},r={},v,ct;r[u.online]=i.Online,r[u.offline]=i.Offline,r[u.appearOffline]=i.Hidden,r[u.busy]=i.Busy,r[u.idle]=i.Idle,r[u.beRightBack]=i.BeRightBack,r[u.away]=i.Away,r[u.inACall]=i.DoNotDisturb,r[u.outToLunch]=i.Away,r[i.Unknown]=u.offline,r[i.Online]=u.online,r[i.Offline]=u.offline,r[i.Hidden]=u.appearOffline,r[i.Busy]=u.busy,r[i.Idle]=u.idle,r[i.BeRightBack]=u.beRightBack,r[i.Away]=u.away,r[i.DoNotDisturb]=u.inACall;var p={Chat:"Chat",Audio:"Audio",Video:"Video",ScreenSharing:"ScreenSharing",DataCollaboration:"DataCollaboration"},ri="DIV",ui="rgba(0, 0, 0, 0.24)",fi="webim/skype_icon.png",ei="webim/Transparent.gif",oi=-1,bi="FB",k="WL",d="SKYPE",ft="SCD",g={};g[d]=1,g[k]=2,g[ft]=3;var si="WebIM",bt=1e5,et=bt,nt=305,ot=!1,tt,it,w,st=0,hi=0,ci={},b={},rt=!1,ht=!1,f,ut=40;v=ti.prototype={},v.isOnline=function(){var n=this._skype!=null?this._skype.status():null;return n!=null&&n!=i.Hidden&&n!=i.Offline&&n!=i.Unknown},v.rank=function(){var t=this._sourceId,n=g[t]||100;return this.isOnline()||(n+=10),n},v.uri=function(){return this._uri},v.dispose=function(){gt(this._subscriptions)},v._updateMessagingAddress=function(n){this._addr._setProperty(!0,n,!0,!0,!0)},v._subscribe=function(){var n=this,f=n._addr,t=n._skype,i=function(){var i=r[t.status()]||u.offline;n._updateMessagingAddress(i)};n._subscriptions.push(t.status.subscribe(i)),i()},ct=ii.prototype={},ct.getCids=function(){var n=this._cids||[],i,t;if(n.length===0){for(i=this._person.getContacts(),t=0;t<i.length;t++)n.push(i[t].getId());this._cids=n}return n},ct.getPreferredSkypeContactUri=function(){for(var r=this._contacts,i=this._contacts[0],u=i.rank(),t,n=1;n<r.length;n++)t=r[n],t.rank()<u&&(i=t,u=t.rank());return i.uri()},ai()})(window.originaljQuery||jQuery),function(n){var r="unload",t=window,u=t.document,i=t.$Do;i.when("wlxim",0,function(){function nt(){n(o).bind("stateChange",y),y(),w=!0,n(t).bind(r,u.dispose)}function et(){t.$Utility.isHighContrast()&&(tt(a),tt(s))}function tt(t){var i=n(t);n("span.is_hc",i).replaceWith($menu.createChevron($menu.chevronTypes.LargeDotLight,!0))}function ot(n){var i=null,t;return n!=null&&(t=n.parentNode,i=t!=null&&p.has(t,"c_ld")?t.nextSibling:n.nextSibling),i}function v(n,t){n!=null&&(n=n.parentNode,p.has(n,"c_ld")&&(n=n.parentNode),n.style.display=t,p.has(n,"c_sml")&&(n=n.parentNode,n.style.display=t))}function st(n){v(n,"block")}function it(n){v(n,"none")}function ht(){for(var n=0;n<f.length;n++)it(f[n])}function y(){var r=o.hasPresence(),s=o.hasNotify(),n,t,i;if(g){if(r){for(n=0;n<f.length;n++)t=f[n],t.style.display=="none"&&c.e(t.parentNode,"block"),v(t,"block");i=o.getPresence(),i&&u.setPresenceRadioButton(i)}else if(o.isLoading())for(u.setPresenceRadioButton(0),n=0;n<f.length;n++)t=f[n],c.d(t),v(t,"block");else ht();o.isError()?st(e("c_wims")):it(e("c_wims"))}}var ct=t.$B,p=t.$css,c=t.$edh,l=t.sutra,e=t._ge,o=t.$WLXIM,rt=t.Microsoft.Live.Messenger,u=t.$HeaderWebIM={},b="c_himla",k="c_himld",a,s,h,ut,f,w,d,g;i.when("wlximuiouter",0,nt),u.init=function(){var n=e("c_memenu");n&&(a=e(b),s=e(k),h=e("c_wimnetsub"),ut=e("c_wimnetsub_m"),f=[a,s],et(),g=!0,w&&y(),l(a,"$Sutra.Shared.Available"),l(s,"$Sutra.Shared.Invisible"),l(h,"$Sutra.Shared.AvailabilityDetails"),l(e("c_wimnetsub_m"),"$Sutra.Shared.ThirdPartyNetworks"))},i.register("$HeaderWebIM.Initialize",u.init),u.dispose=function ft(){d||(i.remove("wlximuiouter",0,nt),w&&n(o).unbind("stateChange",y),n(t).unbind(r,ft),d=!0)},u.SP=function(n){t.$menu.closeCurrent(),o.switchPresence(n),$HeaderWebIM.setPresenceRadioButton(n)},u.setUnreadCountEl=n.noop,u.setPresenceRadioButton=function(n){var u="",i,t,r,e;switch(n){case 0:break;case 2:u=k;break;default:u=b}for(i=0;i<f.length;i++)t=f[i],t&&(r=t.firstChild,r&&(t.id==u?(r.style.visibility="inherit",t.setAttribute("aria-checked","true")):(r.style.visibility="hidden",t.setAttribute("aria-checked","false"))));e=ot(s),e&&e.style.display=="none"&&(n==rt.PresenceStatus.appearOffline?c.d(h):h.style.display=="none"&&c.e(h.parentNode,"block"))},u.toggle=function(n){n.preventDefault(),t.$menu.closeAll()}})}(window.originaljQuery||jQuery),function(){var t,i,n;(function(r){function e(n,t){return k.call(n,t)}function l(n,t){var o,s,u,e,h,y,c,b,i,l,w,r=t&&t.split("/"),a=f.map,v=a&&a["*"]||{};if(n&&n.charAt(0)===".")if(t){for(r=r.slice(0,r.length-1),n=n.split("/"),h=n.length-1,f.nodeIdCompat&&p.test(n[h])&&(n[h]=n[h].replace(p,"")),n=r.concat(n),i=0;i<n.length;i+=1)if(w=n[i],w===".")n.splice(i,1),i-=1;else if(w==="..")if(i===1&&(n[2]===".."||n[0]===".."))break;else i>0&&(n.splice(i-1,2),i-=2);n=n.join("/")}else n.indexOf("./")===0&&(n=n.substring(2));if((r||v)&&a){for(o=n.split("/"),i=o.length;i>0;i-=1){if(s=o.slice(0,i).join("/"),r)for(l=r.length;l>0;l-=1)if(u=a[r.slice(0,l).join("/")],u&&(u=u[s],u)){e=u,y=i;break}if(e)break;!c&&v&&v[s]&&(c=v[s],b=i)}!e&&c&&(e=c,y=b),e&&(o.splice(0,y,e),n=o.join("/"))}return n}function w(n,t){return function(){return o.apply(r,d.call(arguments,0).concat([n,t]))}}function g(n){return function(t){return l(t,n)}}function nt(n){return function(t){u[n]=t}}function a(n){if(e(h,n)){var t=h[n];delete h[n],y[n]=!0,c.apply(r,t)}if(!e(u,n)&&!e(y,n))throw new Error("No "+n);return u[n]}function b(n){var i,t=n?n.indexOf("!"):-1;return t>-1&&(i=n.substring(0,t),n=n.substring(t+1,n.length)),[i,n]}function tt(n){return function(){return f&&f.config&&f.config[n]||{}}}var c,o,v,s,u={},h={},f={},y={},k=Object.prototype.hasOwnProperty,d=[].slice,p=/\.js$/;v=function(n,t){var r,u=b(n),i=u[0];return n=u[1],i&&(i=l(i,t),r=a(i)),i?n=r&&r.normalize?r.normalize(n,g(t)):l(n,t):(n=l(n,t),u=b(n),i=u[0],n=u[1],i&&(r=a(i))),{f:i?i+"!"+n:n,n:n,pr:i,p:r}},s={require:function(n){return w(n)},exports:function(n){var t=u[n];return typeof t!="undefined"?t:u[n]={}},module:function(n){return{id:n,uri:"",exports:u[n],config:tt(n)}}},c=function(n,t,i,f){var p,o,k,b,c,l=[],d=typeof i,g;if(f=f||n,d==="undefined"||d==="function"){for(t=!t.length&&i.length?["require","exports","module"]:t,c=0;c<t.length;c+=1)if(b=v(t[c],f),o=b.f,o==="require")l[c]=s.require(n);else if(o==="exports")l[c]=s.exports(n),g=!0;else if(o==="module")p=l[c]=s.module(n);else if(e(u,o)||e(h,o)||e(y,o))l[c]=a(o);else if(b.p)b.p.load(b.n,w(f,!0),nt(o),{}),l[c]=u[o];else throw new Error(n+" missing "+o);k=i?i.apply(u[n],l):undefined,n&&(p&&p.exports!==r&&p.exports!==u[n]?u[n]=p.exports:k===r&&g||(u[n]=k))}else n&&(u[n]=i)},t=i=o=function(n,t,i,u,e){if(typeof n=="string")return s[n]?s[n](t):a(v(n,t).f);if(!n.splice){if(f=n,f.deps&&o(f.deps,f.callback),!t)return;t.splice?(n=t,t=i,i=null):n=r}return t=t||function(){},typeof i=="function"&&(i=u,u=e),u?c(r,n,t,i):setTimeout(function(){c(r,n,t,i)},4),o},o.config=function(n){return o(n)},t._defined=u,n=function(n,t,i){t.splice||(i=t,t=[]),e(u,n)||e(h,n)||(h[n]=[n,t,i])},n.amd={jQuery:!0}})(),n("vendor/almond",function(){}),n("utils/webProxy",["require"],function(){var t=window.Web=window.Web||{},i,r;return t.Network=t.Network||{},t.Network.registerProxy=function(n){n&&n.frameElement&&(n.frameElement.id==="authIframe"?(t.AuthProxy=n,i&&i()):n.frameElement.id==="pollIframe"&&(t.PollProxy=n,r&&r()))},t.Network.resetAuthProxy=function(){i=null,t.AuthProxy=null},t.Network.resetPollProxy=function(){r=null,t.PollProxy=null},t.Network.onAuthProxyReady=function(n){i=n},t.Network.onPollProxyReady=function(n){r=n},t.Network.resetAuthProxy(),t.Network.resetPollProxy(),t.Network.oninvoke={fire:function(){}},t.Network.onhttperror={fire:function(){}},t.Network.Type=t.Network.Type||{},t.Network.Type.XMLPost="XMLPost",t.Browser=t.Browser||{},t.Browser.isIE=function(){return!0},t}),n("vendor/StringBuilder",["require"],function(){return function(){function t(n){return this._parts.push(n),this}function i(n){return this._parts.push(typeof n=="undefined"||n===null||n===""?"\r\n":n+"\r\n"),this}function r(){if(arguments.length!==0)throw new Error("InvalidParameterCount");this._parts=[],this._value={},this._len=0}function u(){if(arguments.length!==0)throw new Error("InvalidParameterCount");return this._parts.length===0?!0:this.toString()===""}function f(n){var t,r,i;if(n=n||"",t=this._parts,this._len!==t.length&&(this._value={},this._len=t.length),r=this._value,typeof r[n]=="undefined"){if(n!=="")for(i=0;i<t.length;)typeof t[i]=="undefined"||t[i]===""||t[i]===null?t.splice(i,1):i++;r[n]=this._parts.join(n)}return r[n]}var n={};return n.StringBuilder=function(t){this._parts=n.isNullOrEmpty(t)?[]:[t.toString()],this._value={},this._len=0},n.StringBuilder.prototype={append:t,appendLine:i,clear:r,isEmpty:u,toString:f},n.isNullOrEmpty=function(n){return!n||!n.length},n}()}),n("vendor/md5",["require","vendor/StringBuilder"],function(n){var t=n("vendor/StringBuilder");return function(n){function ft(n,t,i){return n&t|~n&i}function et(n,t,i){return n&i|t&~i}function ot(n,t,i){return n^t^i}function st(n,t,i){return t^(n|~i)}function tt(n,t){return n<<t|n>>>32-t}function i(n,t,i,r,u,f,e){return n+=ft(t,i,r)+u+e,n=tt(n,f),n+=t}function r(n,t,i,r,u,f,e){return n+=et(t,i,r)+u+e,n=tt(n,f),n+=t}function u(n,t,i,r,u,f,e){return n+=ot(t,i,r)+u+e,n=tt(n,f),n+=t}function f(n,t,i,r,u,f,e){return n+=st(t,i,r)+u+e,n=tt(n,f),n+=t}function rt(n,t,i,r,u){for(var f=0;f<u;f++)i[r+f]=n[t+f]}var it=n.MSP||{},e=7,o=12,s=17,h=22,c=5,l=9,a=14,v=20,y=4,p=11,w=16,b=23,k=6,d=10,g=15,nt=21,ut=[128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];return it._mD5=function(){this._state=[0,0,0,0],this._count=[0,0],this._buffer=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this._init()},it._mD5.prototype={_init:function(){this._count[0]=this._count[1]=0,this._state[0]=1732584193,this._state[1]=4023233417,this._state[2]=2562383102,this._state[3]=271733878},_updateOperation:function(n,t,i){var r,u,f;if(u=this._count[0]>>>3&63,(this._count[0]+=i<<3)<i<<3&&this._count[1]++,this._count[1]+=i>>>29,f=64-u,i>=f){for(rt(n,t,this._buffer,u,f),this._transform(this._buffer,0),r=f;r+63<i;r+=64)this._transform(n,t+r);u=0}else r=0;rt(n,t+r,this._buffer,u,i-r)},_finalOperation:function(){var t=new Array(16),i=new Array(8),n,r;return this._encode(i,0,this._count,0,8),n=this._count[0]>>>3&63,r=n<56?56-n:120-n,this._updateOperation(ut,0,r),this._updateOperation(i,0,8),this._encode(t,0,this._state,0,16),this._count[0]=this._count[1]=0,this._state[0]=0,this._state[1]=0,this._state[2]=0,this._state[3]=0,this._init(),t},_transform:function(n,t){var tt=this._state[0],it=this._state[1],rt=this._state[2],ut=this._state[3],ft=new Array(16),et;for(this._decode(ft,0,n,t,64),tt=i(tt,it,rt,ut,ft[0],e,3614090360),ut=i(ut,tt,it,rt,ft[1],o,3905402710),rt=i(rt,ut,tt,it,ft[2],s,606105819),it=i(it,rt,ut,tt,ft[3],h,3250441966),tt=i(tt,it,rt,ut,ft[4],e,4118548399),ut=i(ut,tt,it,rt,ft[5],o,1200080426),rt=i(rt,ut,tt,it,ft[6],s,2821735955),it=i(it,rt,ut,tt,ft[7],h,4249261313),tt=i(tt,it,rt,ut,ft[8],e,1770035416),ut=i(ut,tt,it,rt,ft[9],o,2336552879),rt=i(rt,ut,tt,it,ft[10],s,4294925233),it=i(it,rt,ut,tt,ft[11],h,2304563134),tt=i(tt,it,rt,ut,ft[12],e,1804603682),ut=i(ut,tt,it,rt,ft[13],o,4254626195),rt=i(rt,ut,tt,it,ft[14],s,2792965006),it=i(it,rt,ut,tt,ft[15],h,1236535329),tt=r(tt,it,rt,ut,ft[1],c,4129170786),ut=r(ut,tt,it,rt,ft[6],l,3225465664),rt=r(rt,ut,tt,it,ft[11],a,643717713),it=r(it,rt,ut,tt,ft[0],v,3921069994),tt=r(tt,it,rt,ut,ft[5],c,3593408605),ut=r(ut,tt,it,rt,ft[10],l,38016083),rt=r(rt,ut,tt,it,ft[15],a,3634488961),it=r(it,rt,ut,tt,ft[4],v,3889429448),tt=r(tt,it,rt,ut,ft[9],c,568446438),ut=r(ut,tt,it,rt,ft[14],l,3275163606),rt=r(rt,ut,tt,it,ft[3],a,4107603335),it=r(it,rt,ut,tt,ft[8],v,1163531501),tt=r(tt,it,rt,ut,ft[13],c,2850285829),ut=r(ut,tt,it,rt,ft[2],l,4243563512),rt=r(rt,ut,tt,it,ft[7],a,1735328473),it=r(it,rt,ut,tt,ft[12],v,2368359562),tt=u(tt,it,rt,ut,ft[5],y,4294588738),ut=u(ut,tt,it,rt,ft[8],p,2272392833),rt=u(rt,ut,tt,it,ft[11],w,1839030562),it=u(it,rt,ut,tt,ft[14],b,4259657740),tt=u(tt,it,rt,ut,ft[1],y,2763975236),ut=u(ut,tt,it,rt,ft[4],p,1272893353),rt=u(rt,ut,tt,it,ft[7],w,4139469664),it=u(it,rt,ut,tt,ft[10],b,3200236656),tt=u(tt,it,rt,ut,ft[13],y,681279174),ut=u(ut,tt,it,rt,ft[0],p,3936430074),rt=u(rt,ut,tt,it,ft[3],w,3572445317),it=u(it,rt,ut,tt,ft[6],b,76029189),tt=u(tt,it,rt,ut,ft[9],y,3654602809),ut=u(ut,tt,it,rt,ft[12],p,3873151461),rt=u(rt,ut,tt,it,ft[15],w,530742520),it=u(it,rt,ut,tt,ft[2],b,3299628645),tt=f(tt,it,rt,ut,ft[0],k,4096336452),ut=f(ut,tt,it,rt,ft[7],d,1126891415),rt=f(rt,ut,tt,it,ft[14],g,2878612391),it=f(it,rt,ut,tt,ft[5],nt,4237533241),tt=f(tt,it,rt,ut,ft[12],k,1700485571),ut=f(ut,tt,it,rt,ft[3],d,2399980690),rt=f(rt,ut,tt,it,ft[10],g,4293915773),it=f(it,rt,ut,tt,ft[1],nt,2240044497),tt=f(tt,it,rt,ut,ft[8],k,1873313359),ut=f(ut,tt,it,rt,ft[15],d,4264355552),rt=f(rt,ut,tt,it,ft[6],g,2734768916),it=f(it,rt,ut,tt,ft[13],nt,1309151649),tt=f(tt,it,rt,ut,ft[4],k,4149444226),ut=f(ut,tt,it,rt,ft[11],d,3174756917),rt=f(rt,ut,tt,it,ft[2],g,718787259),it=f(it,rt,ut,tt,ft[9],nt,3951481745),this._state[0]+=tt,this._state[1]+=it,this._state[2]+=rt,this._state[3]+=ut,et=0;et<ft.length;et++)ft[et]=0},_encode:function(n,t,i,r,u){for(var o=t+u,e=r,f=t;f<o;e++,f+=4)n[f]=i[e]&255,n[f+1]=i[e]>>>8&255,n[f+2]=i[e]>>>16&255,n[f+3]=i[e]>>>24&255},_decode:function(n,t,i,r,u){for(var o=r+u,e=t,f=r;f<o;e++,f+=4)n[e]=i[f]|i[f+1]<<8|i[f+2]<<16|i[f+3]<<24},digest:function(n){for(var r=new Array(n.length),i=0;i<n.length;i++)r[i]=n.charCodeAt(i);this._updateOperation(r,0,r.length);var u=this._finalOperation(),e="0123456789abcdef",f=new t.StringBuilder;for(i=0;i<u.length;i++)f.append(e.charAt(u[i]>>>4&15)),f.append(e.charAt(u[i]&15));return f.toString()}},it._mD5}(window)}),n("vendor/BigInt",["require","vendor/StringBuilder"],function(n){var t=n("vendor/StringBuilder");return function(){var r="0123456789abcdef",u=16,i=3,n=function(n,t){this._elements=[],this._radix=n,this._elements.insert(0,t),this._length=1,this._normalize()};return n.hexRadix=16,n.decRadix=1e3,n._createDec=function(t){return new n(n.decRadix,t)},n._createHex=function(t){return new n(n.hexRadix,t)},n._computeHexNegative=function(t,i){for(var f=[],r=0;r<i;r++)f.insert(r,t[r]);for(r=0;r<f.length;r++)f[r]>0&&(f[r]=n.hexRadix-f[r],r+1<f.length?f[r+1]=f[r+1]+1:f.length<u&&f.insert(r+1,1));return f},n.parseDecInt=function(t,i){switch(t){case n.decRadix:return n._parseDecIntToDecRadixBigInt(i);case n.hexRadix:return n._parseDecIntToHexRadixBigInt(i);default:return null}},n._parseDecIntToHexRadixBigInt=function(i){var f,o;if(t.isNullOrEmpty(i))return null;f=i.charAt(0)==="-",f&&(i=i.substr(1));var r=9,l=n._createHex(1e9),e=n._createHex(0),a=Math.ceil(i.length/r),s=n._createHex(1),u=i.length;for(o=0;o<a;o++){var h=u-r<0?0:u-r,v=parseInt(i.substr(h,u-h),10),c=n._createHex(v);c.multiply(s),e.add(c),s.multiply(l),u-=r}return e._isNegative=f,e},n._parseDecIntToDecRadixBigInt=function(t){var e,f,r,u;if(t.length===0)return n._createDec(0);for(e=!1,f=[],t.charAt(0)==="-"&&(e=!0,t=t.substr(1,t.length-1)),r=0;i*(r+1)<=t.length;r++)f.insert(r,parseInt(t.substring(t.length-i*(r+1),t.length-i*r),10));return 0!=t.length%i&&f.insert(r++,parseInt(t.substring(0,t.length%i),10)),u=n._createDec(0),u._elements=f,u._length=r,u._isNegative=e,u},n._getHexValues=function(t){for(var r=new Array(t.length),i=0;i<t.length;i++)if(r[i]=n._hexCharValue(t.charAt(i)),r[i]<0)return null;return r},n._hexCharValue=function(n){if(n>="0"&&n<="9")return n-"0";switch(n){case"a":return 10;case"b":return 11;case"c":return 12;case"d":return 13;case"e":return 14;case"f":return 15;default:return-1}},n._toNegativeValues=function(n){for(var t=n.length-1;t>=0;t--)n[t]>0&&(n[t]=16-n[t],t>0&&(n[t-1]+=1));return n},n.prototype={_isNegative:!1,_length:0,_radix:0,_normalize:function(){for(var i,t,n=this._length-1;n>=0;n--)if(this._elements[n]===0)this._length--;else break;for(i=0;i<2;i++)if(this._length===0)this._isNegative=!1;else{if(this._elements[this._length-1]<0){for(n=0;n<this._length;n++)this._elements[n]=-this._elements[n];this._isNegative=!this._isNegative}for(n=0;n<this._length-1;n++)this._elements[n]<0&&(t=Math.ceil(-this._elements[n]/this._radix),this._elements[n]=this._elements[n]+this._radix*t,this._elements[n+1]=this._elements[n+1]-t),this._elements[n]>=this._radix&&(t=Math.floor(this._elements[n]/this._radix),this._elements[n]=this._elements[n]%this._radix,this._elements[n+1]=this._elements[n+1]+t);while(this._elements[this._length-1]>=this._radix)this._ensureCapacity(),this._elements[this._length]=Math.floor(this._elements[this._length-1]/this._radix),this._elements[this._length-1]=this._elements[this._length-1]%this._radix,this._length++;if(this._elements[this._length-1]<0){for(n=0;n<this._length;n++)this._elements[n]=-this._elements[n];this._isNegative=!this._isNegative}else break}},_ensureCapacity:function(){this._length===this._elements.length&&this._elements.push(0)},add:function(n){for(var t=0;t<this._length-n._length;t++)n._elements.insert(n._length+t,0);for(t=0;t<n._length-this._length;t++)this._elements.insert(this._length+t,0);if(this._length=Math.max(n._length,this._length),this._isNegative===n._isNegative)for(t=0;t<this._length;t++)this._elements[t]=this._elements[t]+n._elements[t];else for(t=0;t<this._length;t++)this._elements[t]=this._elements[t]-n._elements[t];this._normalize()},multiply:function(t){for(var r=new n(this._radix,0),u,i=0;i<t._length+this._length;i++)i<r._elements.length?r._elements[i]=0:r._elements.insert(i,0);for(i=0;i<t._length;i++){for(u=0;u<this._length;u++)r._elements[i+u]=r._elements[i+u]+t._elements[i]*this._elements[u],r._elements[i+u]!==0&&(r._length=Math.max(r._length,i+u+1));r._normalize()}r._isNegative=t._isNegative!==this._isNegative,this._elements=r._elements,this._isNegative=r._isNegative,this._length=r._length},modulus:function(n){for(var i,r,u,f,t;;){if(n._length===0||this._length===0)break;if(i=this._length-n._length,i<0)break;if(r=this._elements[this._length-1],u=n._elements[n._length-1],r>=u){for(f=Math.floor(r/u),t=0;t<n._length;t++)this._elements[t+i]=this._elements[t+i]-f*n._elements[t];this._normalize();continue}if(i===0)break;this._elements[this._length-2]=this._elements[this._length-2]+this._radix*this._elements[this._length-1],this._length--}this._isNegative&&(n._isNegative?(n._isNegative=!1,this.add(n),n._isNegative=!0):this.add(n)),this._normalize()},toString:function(){switch(this._radix){case n.hexRadix:return this._toHexString();case n.decRadix:return this._toDecString();default:return""}},_toHexString:function(){var i,e,f,u;if(this._elements.length===0)return"0";for(i=this._elements,this._isNegative&&(i=n._computeHexNegative(i,this._length)),e=new t.StringBuilder,f=!1,u=i.length-1;u>=0;u--)f||i[u]!==0&&(f=!0),f&&e.append(r.charAt(i[u]));return e.toString()},_toDecString:function(){var n,t,i;if(this._length===0)return"0";for(n="",t=0;t<this._length;t++)if(n=this._elements[t]+n,t<this._length-1)for(i=10;i<this._radix;i*=10)this._elements[t]<i&&(n=0+n);return this._isNegative&&(n="-"+n),n}},n}()}),n("vendor/ConvertHelper",[],function(){return function(){return{tryParseInt:function(n){var t=parseInt(n,10);return isNaN(t)?-1:t},parseHexInt:function(n){var t=parseInt(n,16);return isNaN(t)?0:t}}}()}),n("vendor/md5Auth",["require","vendor/md5","vendor/StringBuilder","vendor/BigInt","vendor/ConvertHelper"],function(n){var u=n("vendor/md5"),r=n("vendor/StringBuilder"),t=n("vendor/BigInt"),i=n("vendor/ConvertHelper");return function(n){function o(n){return(new u).digest(n)}function f(n,t){for(var u=n.toString(2),f=t.toString(2),o=new r.StringBuilder,e=new r.StringBuilder,s=Math.abs(u.length-f.length),i=0;i<s;i++)e.append("0");for(u.length<f.length?(e.append(u),u=e.toString()):f.length<u.length&&(e.append(f),f=e.toString()),i=0;i<u.length;i++)o.append(u.charAt(i)===f.charAt(i)?"0":"1");return parseInt(o.toString(),2)}function s(n,t,i){return n.length<t?(i=i||" ",n+h(i,t-n.length)):n.valueOf()}function h(n,t){for(var r=n,i=1;i<t;i++)r+=n;return r}var e=n.MSP||{};return e._mD5Auth=function(){},e._mD5Auth.prototype={_int32ToHexString:function(n){for(var u="0123456789abcdef",i=new r.StringBuilder,t=0;t<=3;t++)i.append(u.charAt(n>>t*8+4&15)),i.append(u.charAt(n>>t*8&15));return i.toString()},getMacMD5Hash:function(n,t,r){var w=n+t,l=w,y=8-l.length%8,p,c,u,e,h,v,a;for(y!==8&&(l=s(l,l.length+y,"0")),p=l.length/4,c=[],u=0,e=0;u<p;u++)c.insert(u,0),c[u]=c[u]+l.charCodeAt(e++)*1,c[u]=c[u]+l.charCodeAt(e++)*256,c[u]=c[u]+l.charCodeAt(e++)*65536,c[u]=c[u]+l.charCodeAt(e++)*16777216;for(h=new Array(4),v=o(n+r),u=0,e=0;u<h.length;u++)h[u]=0,h[u]+=i.parseHexInt(v.substr(e,2))*1,e+=2,h[u]+=i.parseHexInt(v.substr(e,2))*256,e+=2,h[u]+=i.parseHexInt(v.substr(e,2))*65536,e+=2,h[u]+=i.parseHexInt(v.substr(e,2))*16777216,e+=2;a=new Array(2),this._cS64_C(c,h,a);var b=f(h[0],a[0]),k=f(h[1],a[1]),d=f(h[2],a[0]),g=f(h[3],a[1]);return this._int32ToHexString(b)+this._int32ToHexString(k)+this._int32ToHexString(d)+this._int32ToHexString(g)},_cS64_C:function(n,i,r){var f=2147483647,h;if(n.length<2||(n.length&1)==1)return!1;var v=i[0]&f,y=i[1]&f,p=i[2]&f,w=i[3]&f,b=242854337,k=t.parseDecInt(t.decRadix,v.toString()),c=t.parseDecInt(t.decRadix,y.toString()),d=t.parseDecInt(t.decRadix,p.toString()),l=t.parseDecInt(t.decRadix,w.toString()),g=t.parseDecInt(t.decRadix,b.toString()),a=0,e=t.parseDecInt(t.decRadix,f.toString()),s=t.parseDecInt(t.decRadix,"0"),u=t.parseDecInt(t.decRadix,"0"),o=t.parseDecInt(t.decRadix,"0");for(h=0;h<n.length/2;h++)s=t.parseDecInt(t.decRadix,n[a++].toString()),s.multiply(g),s.modulus(e),u.add(s),u.multiply(k),u.add(c),u.modulus(e),o.add(u),u.add(t.parseDecInt(t.decRadix,n[a++].toString())),u.multiply(d),u.add(l),u.modulus(e),o.add(u);return u.add(c),u.modulus(e),o.add(l),o.modulus(e),r[0]=parseInt(u.toString(),10),r[1]=parseInt(o.toString(),10),!0}},Array.prototype.insert=function(n,t){this.splice(n,0,t)},e._mD5Auth}(window)}),n("utils/endpoint",["require","exports","module"],function(n,t){function r(){function u(n){var t=Math.random()*16|0,i=n==="x"?t:t&3|8;return i.toString(16)}var n,r,t;try{if(n=localStorage.getItem(i),n)return n}catch(f){}r="{xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx}",t=r.replace(/[xy]/g,u);try{localStorage.setItem(i,t)}catch(f){}return t}var i="MailNotify:EPID";t.getOrCreateEpid=r}),n("utils/request",["require","exports","module"],function(n,t){function i(n,t){var i={verb:"POST",url:n,headers:{"X-Requested-Session-Content-Type":"text/html","X-MSN-Auth":"Use-Cookie","Content-Type":"text/html; charset=UTF-8"}};return i.postString=t||"",i}t.createRequestJson=i}),n("main",["require","utils/webProxy","vendor/md5Auth","utils/endpoint","utils/request"],function(n){function h(n){var r=n.responseText.match(/<xfr><target>([^<]*)<\/target>/);return r?(t.host="https://"+r[1],i.Network.resetAuthProxy(),i.Network.resetPollProxy(),b(),!0):!1}function c(n,r){t.host=n,i.Network.resetPollProxy(),w(r||v)}function f(){return tt++}function l(n){o=n.getResponseHeader(g).split(";")[0].split("=")[1]}function ut(){var n="\r\n<connect><ver>2<\/ver><agent><os>"+u.os+"<\/os><osVer>"+u.osVer+"<\/osVer><proc>"+u.proc+"<\/proc><lcid>"+u.lcid+"<\/lcid><\/agent><\/connect>",o="\r\n<user><web-compact-ticket /><\/user>",y="\r\n<msgr><ver>2<\/ver><client><name>msgrliboutlook<\/name><ver>908/6.4.0.0<\/ver><\/client><epid>"+nt+"<\/epid><\/msgr>",p="CNT "+f()+" CON "+n.length+"\r\n"+n+"ATH "+f()+" CON\\USER "+o.length+"\r\n"+o+"BND "+f()+" CON\\MSGR "+y.length+"\r\n"+y,b=e.createRequestJson(t.host+"/gateway/gateway.dll?Version=1&Protocol=mtp&Action=open&Server=NS&IP=none",p);i.AuthProxy.fetchXML(b,undefined,undefined,function(n){if(!h(n)&&n.status===200){var t="https://"+n.getResponseHeader(s);c(t,function(n){return function(){l(n),a=n.responseText.match(/Set-Registration:\s(\S+)/)[1],r=n.responseText.match(/<msgr-response>.+<nonce>([^>]+)<\/nonce>/),w(function(){r?(r=r[1],ft()):v()})}}(n))}})}function ft(){var u=new k,n="Registration: "+a+"\r\n\r\n<challenge><appId>"+t.appId+"<\/appId><response>"+u.getMacMD5Hash(r,t.appId,t.key)+"<\/response><\/challenge>",y="PUT "+f()+" MSGR\\CHALLENGE "+n.length+"\r\n"+n,p=e.createRequestJson(t.host+"/gateway/gateway.dll?SessionID="+o,y);i.PollProxy.fetchXML(p,undefined,undefined,function(n){if(!h(n)&&n.status===200){var i="https://"+n.getResponseHeader(s);if(t.host!==i){c(i);return}l(n),v()}})}function v(){var n="Registration: "+a+"\r\n\r\n<subscribe><notifications><partners><partner>Hotmail<\/partner><\/partners><\/notifications><\/subscribe>",r="PUT "+f()+" MSGR\\SUBSCRIPTIONS "+n.length+"\r\n"+n,u=e.createRequestJson(t.host+"/gateway/gateway.dll?SessionID="+o,r);i.PollProxy.fetchXML(u,undefined,undefined,function(n){if(!h(n)&&n.status===200){var i="https://"+n.getResponseHeader(s);if(t.host!==i){c(i);return}l(n),y()}})}function y(){var n=e.createRequestJson(t.host+"/gateway/gateway.dll?Action=poll&Lifespan=60&SessionID="+o);i.PollProxy.fetchXML(n,undefined,undefined,function(n){if(!h(n)&&n.status===200){var i="https://"+n.getResponseHeader(s);if(t.host!==i){c(i);return}l(n),n.responseText.length>0&&/^NFY \d+ MSGR\\HOTMAIL/.test(n.responseText)&&ot(n.responseText),y()}})}function et(n){if(!n)return 6;switch(n.toLowerCase()){case"active":return 0;case"saved":return 3;case"draft":return 4;case"trash":return 1;case"hm_bulkmail_":return 2;case"00000000-0000-0000-0000-000000000006":case"00000000-0000-0000-0000-000000000007":case"00000000-0000-0000-0000-000000000008":case"00000000-0000-0000-0000-000000000009":return 6;default:return 5}}function ot(n){var u=n.substr(n.search(/mime-version/i)),r=n.match(/content-type: (text\/x-msmsgs[a-z]+);/i)[1],i;r.toLowerCase()==="text/x-msmsgsemailnotification"&&(i={},i.folder=et(n.match(/dest-folder: ([a-z0-9_-]+)/i)[1]),i.messageUrl=t.messageUrlHost+n.match(/message-url: (.+)/i)[1],i.sender=n.match(/from: (.+)/i)[1],i.senderAddress=n.match(/from-addr: (.+)/i)[1],i.subject=n.match(/subject: (.+)/i)[1],jQuery(t).trigger("emailNotification",i))}function p(n){st(n);var i=document.createElement("iframe");i.src=t.host+"/xmlProxy.htm?vn="+t.xmlProxyVersion+"&domain="+t.xmlProxyDomain,i.id=n,i.style.display="none",document.body.appendChild(i)}function st(n){var t=document.getElementById(n);t&&t.parentNode.removeChild(t)}function w(n){i.Network.onPollProxyReady(n);p(rt)}function b(){i.Network.onAuthProxyReady(ut);p(it)}function ht(n){if(!n||!n.os||!n.osVer||!n.proc||!n.lcid)throw new Error("Agent information is required. Please provide os, osVer, proc and lcid");u=n,b()}var i=n("utils/webProxy"),k=n("vendor/md5Auth"),d=n("utils/endpoint"),e=n("utils/request"),t={},a,r,o,u,s="X-MSN-Host",g="X-MSN-Messenger",nt=d.getOrCreateEpid(),tt=1,it="authIframe",rt="pollIframe";t.startPoll=ht,t.host="https://geo.gateway.messenger.live.com",t.messageUrlHost="http://www.hotmail.msn.com",t.appId="PROD0090YUAUV{2B",t.key="YMM8C_H7KCQ2S_KL",t.xmlProxyVersion="9.090515.0",t.xmlProxyDomain="live.com",window.$MailNotify=t,$Do.register("$MailNotify.init")}),i(["main"])}(),function(){"use strict";function u(){var u=n.$MailNotify;if(i.SwxShim){switch(i.WebIM.ev){case"integration":u.host="https://vip.gateway.edge.messenger.live-int.com",u.xmlProxyDomain="live-int.com",u.messageUrlHost="http://www.hotmail.msn-int.com";break;case"dogfood":u.host="https://dogfood.gateway.messenger.live.com"}u.init=function(){t||(u.startPoll({os:"winnt",osVer:"5.2",proc:"x86",lcid:"en-us"}),t=!0)},u.register=function(n){jQuery(u).on("emailNotification",n);t||u.init()},u.unregister=function(n){jQuery(u).off("emailNotification",n)},r.register("$MailNotify")}}var n=window,i=n.$Config,r=n.$Do,t=!1;r.when("$MailNotify.init",0,u)}(),window.JSDownload_swxim=1