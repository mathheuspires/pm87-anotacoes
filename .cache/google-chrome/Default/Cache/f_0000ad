(function(){var n=ol.templateMap=ol.templateMap||{};n["#searchDatePickerMenuTemplate"]={tmpls:[],links:{},tags:{},bnds:[{fn:function(n){return{params:"Title",props:{},args:[n.Title]}},paths:["Title"],_ctxs:">"},{fn:function(n,t){return[{tmpl:0,params:'~sutraTag="searchfiltersdatefield"                               ~autocomplete="off"                               ~spellCheck="false"                               ~name="searchFiltersDate"                               ~id="searchFiltersDate"                               ~maxLength=~ol.config.search.maxFieldLength                               ~placeholder=~ol.config.search.dateFormat                               ~data=~tag                               ~propertyName="Date"                           ',props:{},ctx:{sutraTag:"searchfiltersdatefield",autocomplete:"off",spellCheck:"false",name:"searchFiltersDate",id:"searchFiltersDate",maxLength:t.hlp("ol").config.search.maxFieldLength,placeholder:t.hlp("ol").config.search.dateFormat,data:t.hlp("tag"),propertyName:"Date"},args:[]}]},paths:[],_ctxs:"watermarkedInputControl"},{fn:function(n,t){return[{tmpl:0,params:"~tag.DateRangeMenu ",props:{},args:[t.hlp("tag").DateRangeMenu]}]},paths:["~tag.DateRangeMenu"],_ctxs:"menuControl"}],_is:"template",allowCode:!0,tmplName:"searchDatePickerMenuTemplate",htmlTag:"a",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._tag,o=i._cnvt,u="";return u+='  <a href="#" class="c_ml ',u+=(f=n.MenuAnchorClass)!=r?f:"",u+='">    <span class="',u+=(f=n.TitleClass)!=r?f:"",u+='" title="',u+=(f=n.ToolTip)!=r?f:"",u+='">',u+=o("html",t,1),u+='<\/span>    <img src="./clear.gif" class="',u+=(f=n.MenuChevClass)!=r?f:"",u+='"/>  <\/a>  <ul class="c_m t_hovl">      <li class="',u+=(f=n.CssClass)!=r?f:"",u+='" data-link="class{:CssClass}">          <div class="datePickerPanel">              <div>                  <div class="datePickerColumn">                      <div class="datePickerLabel">                          <label for="searchFiltersDate">',u+=(f=t.hlp("ol").GetString("Search.Date"))!=r?f:"",u+="<\/label>                      <\/div>                      <div>                          ",u+=e("watermarkedInputControl",t,this,2),u+='                      <\/div>                  <\/div>                  <div class="dateRangePickerColumn">                      <div class="datePickerLabel">                          <label for="advSearchDateRange">',u+=(f=t.hlp("ol").GetString("Search.DateRange"))!=r?f:"",u+='<\/label>                      <\/div>                      <div>                          <div class="c_mcp boxStyle">',u+=e("menuControl",t,this,3),u+='<\/div>                      <\/div>                  <\/div>              <\/div>              <div class="datePickerButtonPanel">                <button type="button" class="default applyFiltersBtn">',u+=(f=t.hlp("ol").GetString("SearchFilters.Apply"))!=r?f:"",u+"<\/button>              <\/div>          <\/div>      <\/li>  <\/ul>"}}},n["#searchFiltersTemplate"]={tmpls:[{tmpls:[{tmpls:[],links:{},tags:{},bnds:[{fn:function(n,t){return[{tmpl:0,params:"~tag.FolderSelector ",props:{},args:[t.hlp("tag").FolderSelector]}]},paths:["~tag.FolderSelector"],_ctxs:"containerSelectorControl"},{fn:function(n,t){return[{tmpl:0,params:"~tag.CategorySelector ",props:{},args:[t.hlp("tag").CategorySelector]}]},paths:["~tag.CategorySelector"],_ctxs:"containerSelectorControl"},{fn:function(n,t){return[{tmpl:0,params:"~tag.AttachmentMenu ",props:{},args:[t.hlp("tag").AttachmentMenu]}]},paths:["~tag.AttachmentMenu"],_ctxs:"menuControl"},{fn:function(n,t){return[{tmpl:0,params:"~tag.DatePickerMenu ",props:{},args:[t.hlp("tag").DatePickerMenu]}]},paths:["~tag.DatePickerMenu"],_ctxs:"searchDatePickerMenuControl"}],_is:"template",allowCode:!0,htmlTag:"li",tmplName:"searchFiltersTemplate/if/if",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+='                        <li class="c_mcp">                            ',r+=u("containerSelectorControl",t,this,1),r+='                        <\/li>                        <li class="c_mcp">                            ',r+=u("containerSelectorControl",t,this,2),r+='                        <\/li>                        <li class="c_mcp">                            ',r+=u("menuControl",t,this,3),r+='                        <\/li>                        <li class="c_mcp">                            ',r+=u("searchDatePickerMenuControl",t,this,4),r+"                        <\/li>                      "}}}],links:{},tags:{},bnds:[{fn:function(n,t){return{params:"~tag.FiltersSummaryText",props:{},args:[t.hlp("tag").FiltersSummaryText]}},paths:["~tag.FiltersSummaryText"],_ctxs:">"},{fn:function(n,t){return[{tmpl:1,params:"~tag.SubMenusCreated ",props:{},args:[t.hlp("tag").SubMenusCreated]}]},paths:["~tag.SubMenusCreated"],_ctxs:"if"}],_is:"template",allowCode:!0,htmlTag:"li",tmplName:"searchFiltersTemplate/if",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,f=i._cnvt,r="";return r+="        ",r+='        <li class="FilterSelector c_mcp ToolbarItemFirst">            <span class="filtersContainer">                <span class="c_mcp">                    <a class="c_ml filterBarMenu searchFiltersMenuLink TextSizeSmall" href="#">                        <span class="searchFiltersMenuTitle">',r+=f("html",t,1),r+='<\/span>                        <img src="./clear.gif" class="ExcoOpenSmall"/>                    <\/a>                    <ul class="c_m t_hovl searchFiltersMenu">                        ',r+=u("if",t,this,2),r+"                    <\/ul>                <\/span>            <\/span>        <\/li>    "}}},{tmpls:[],links:{},tags:{},bnds:[{fn:function(n,t){return[{tmpl:0,params:"~tag.FolderSelector ",props:{},args:[t.hlp("tag").FolderSelector]}]},paths:["~tag.FolderSelector"],_ctxs:"containerSelectorControl"},{fn:function(n,t){return[{tmpl:0,params:"~tag.CategorySelector ",props:{},args:[t.hlp("tag").CategorySelector]}]},paths:["~tag.CategorySelector"],_ctxs:"containerSelectorControl"},{fn:function(n,t){return[{tmpl:0,params:"~tag.AttachmentMenu ",props:{},args:[t.hlp("tag").AttachmentMenu]}]},paths:["~tag.AttachmentMenu"],_ctxs:"menuControl"},{fn:function(n,t){return[{tmpl:0,params:"~tag.DatePickerMenu ",props:{},args:[t.hlp("tag").DatePickerMenu]}]},paths:["~tag.DatePickerMenu"],_ctxs:"searchDatePickerMenuControl"}],_is:"template",allowCode:!0,htmlTag:"li",tmplName:"searchFiltersTemplate/else",fn:{fn:function(n,t,i,r){var i=i||jsviews,e,f=i._tag,u="";return u+="        ",u+='        <li class="FilterSelector ToolbarItemFirst">            <span class="filtersContainer">                <span class="TextSizeSmall">',u+=(e=t.hlp("ol").GetString("SearchFilters.FilterByParam").format(""))!=r?e:"",u+='<\/span>            <\/span>        <\/li>        <li class="FilterSelector c_mcp ToolbarItem">            <span class="filtersContainer">                <span class="c_mcp">',u+=f("containerSelectorControl",t,this,1),u+='<\/span>            <\/span>        <\/li>        <li class="FilterSelector c_mcp ToolbarItem">            <span class="filtersContainer">                <span class="c_mcp">',u+=f("containerSelectorControl",t,this,2),u+='<\/span>            <\/span>        <\/li>        <li class="FilterSelector c_mcp ToolbarItem">            <span class="filtersContainer">                <span class="c_mcp">',u+=f("menuControl",t,this,3),u+='<\/span>            <\/span>        <\/li>        <li class="FilterSelector c_mcp ToolbarItem">            <span class="filtersContainer">                <span class="c_mcp">',u+=f("searchDatePickerMenuControl",t,this,4),u+"<\/span>            <\/span>        <\/li>    "}}}],links:{},tags:{},bnds:[{fn:function(n,t){return[{tmpl:1,params:"~tag.layout.ReadingPaneMode === ~HM.ReadingPaneLocation.Right ",props:{},args:[t.hlp("tag").layout.ReadingPaneMode===t.hlp("HM").ReadingPaneLocation.Right]},{tmpl:2,params:"",props:{},args:[]}]},paths:["~tag.layout.ReadingPaneMode","~HM.ReadingPaneLocation.Right"],_ctxs:"else"}],_is:"template",allowCode:!0,tmplName:"searchFiltersTemplate",htmlTag:"li",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._tag,o=i._cnvt,u="";return u+="    ",u+=e("if",t,this,1),u+='    <li class="',u+=o("getClearFiltersItemClass",t,{params:"~tag.layout.ReadingPaneMode ~tag.AreSearchFiltersDefault",props:{},args:[t.hlp("tag").layout.ReadingPaneMode,t.hlp("tag").AreSearchFiltersDefault]}),u+='" data-link="class{getClearFiltersItemClass:~tag.layout.ReadingPaneMode ~tag.AreSearchFiltersDefault}">      <a class="resetFiltersBtn TextSizeSmall" href="#">',u+=(f=t.hlp("ol").GetString("SearchFilters.ClearFilters"))!=r?f:"",u+"<\/a>    <\/li>"}}}})(),function(){"use strict";function r(){return{title:"",menuAnchorClass:"",titleClass:"",items:[],params:{offset:i},loc:1,menuChevClass:"ExcoOpenSmall",sutraTag:"",toolTip:"",date:"",dateRange:""}}var n=window.ol=window.ol||{},t=n.vm=n.vm||{},f=n.Accessor,i=5,u=t.SearchDatePickerMenu=function(n){this.initAccessorValues(n)};n.AddOptionsAccessorAndInitFunctions(u.prototype,r)}(),function(n,t){"use strict";var i=n.vm,r="searchDatePickerMenuTemplate",u={templateId:r,template:t.templates("#"+r),attr:"html",init:function(n){this.data=n.args[0],this.initializeDateFromVM()},initializeDateFromVM:function(){this.date(this.data.date()),this.dateRange(this.data.dateRange()),this.createDateRangeMenu()},render:function(){return this.tagCtx.render(this.data)},date:function(t){return n.Accessor(this,"Date",t)},dateRange:function(t){return n.Accessor(this,"DateRange",t)},dateRangeMenu:function(t){return n.Accessor(this,"DateRangeMenu",t)},onAfterLink:function(){var i=this,r=this.contents(),u;i.$menuElt=r.filter(".c_m"),r.filter(".c_ml").click(function(r){i.initializeDateFromVM(),$menu.create(r,i.data.Loc,i.data.Params);var u=t(this).view().data;return n.Cmd("menu.open").bubble(r.currentTarget,{key:u.Key}),!1}),u=function(t){var r={key:"dateselected",date:i.date(),dateRange:i.dateRange()};n.Cmd("searchdatepicker.select").bubble(t.currentTarget,r),i.close()};r.on("keypress","button.applyFiltersBtn",function(n){if(n.keyCode==13||n.keyCode==32)return u(n),!1});r.on("keyup","input#searchFiltersDate",function(n){n.keyCode==13&&u(n)});r.on("click",".applyFiltersBtn",function(n){return u(n),!1})},onCmdBubble:function(n,t,i){t.name==="menu.click"&&i.key==="dateRange"&&(this.dateRange(i.dateRange),this.createDateRangeMenu())},createDateRangeMenu:function(){var u,r,t,f;if(this.dateRangeMenu())this.dateRangeMenu().title(this.getDateRangeTitle());else{for(u=[],r=this.base.getDateRangeMenuData(),t=0;t<r.length;t++)f=n.GetString("Search.DateRange."+r[t].text),u.push(new i.MenuItem({text:f,key:"dateRange",eventData:{dateRange:r[t].value}}));this.dateRangeMenu(new i.Menu({title:this.getDateRangeTitle(),menuAnchorClass:"dateRangePicker",loc:0,items:u}))}},getDateRangeTitle:function(){return this.base.getDateRangeTitle(this.dateRange())},isOpen:function(){return this.$menuElt.css("visibility")!=="hidden"},close:function(){$menu.closeCurrent()}};u.base=n.c.searchBaseControl,t.views.tags({searchDatePickerMenuControl:u}),t.templates("#searchDatePickerMenuTemplate")}(window.ol,window.originaljQuery||window.jQuery),function(n){"use strict";var t=ol.vm,i="searchFiltersTemplate",u=n.templates(null,{markup:"#"+i,converters:{getClearFiltersItemClass:function(n,t){return"ToolbarItem"+(n===HM.ReadingPaneLocation.Right?" FloatRight":" InlineFilterButton")+(t?" NoDisplay":"")}}}),r={templateId:i,template:u,attr:"html",init:function(n){var t=this,r=n.ctx,i;t.layout=r.layout,t.search=r.search,t.layout.readingPaneMode()===HM.ReadingPaneLocation.Right&&t.updateFiltersSummaryTitle(),i=t.layout.readingPaneMode()===HM.ReadingPaneLocation.Right,t.subMenuOptions={menuAnchorClass:i?"filterBarSubMenu":"filterBarMenu TextSizeSmall",titleClass:i?"searchFilterSubMenuTitle":"searchFilterMenuTitle",loc:i?6:0,menuChevClass:i?"ExcoClosedNormal":"ExcoOpenSmall"},t.layout.ReadingPaneMode!==HM.ReadingPaneLocation.Right&&t.createSubMenus(),t.updateAreSearchFiltersDefault()},onDispose:function(){this.$searchFiltersMenuLink&&(this.$searchFiltersMenuLink.off("click",this._onSearchFiltersMenuLink),this.$searchFiltersMenuLink=null),this.$resetFiltersLink&&(this.$resetFiltersLink.off("click",this._onClearFiltersLinkClicked),this.$resetFiltersLink=null),this._onSearchVMPropertyChange&&(n.observable.simpleOff(this.search,"propertyChange",this._onSearchVMPropertyChange),this._onSearchVMPropertyChange=null)},folderSelector:function(n){return ol.Accessor(this,"FolderSelector",n)},categorySelector:function(n){return ol.Accessor(this,"CategorySelector",n)},datePickerMenu:function(n){return ol.Accessor(this,"DatePickerMenu",n)},attachmentMenu:function(n){return ol.Accessor(this,"AttachmentMenu",n)},areSearchFiltersDefault:function(n){return ol.Accessor(this,"AreSearchFiltersDefault",n)},subMenusCreated:function(n){return ol.Accessor(this,"SubMenusCreated",n)},createSubMenus:function(){var n=this;n.subMenusCreated()||(n.createFolderSelector(),n.createCategorySelector(),n.createDatePickerMenu(),n.createAttachmentMenu(),n.subMenusCreated(!0))},onAfterLink:function(){var t=this,i=n(this.nodes());this.$searchFiltersMenuLink=i.find(".searchFiltersMenuLink"),this.$resetFiltersLink=i.find(".resetFiltersBtn"),this._onSearchFiltersMenuLink=function(n){return t.createSubMenus(),$menu.create(n,0),!1};this.$searchFiltersMenuLink.on("click",this._onSearchFiltersMenuLink);this._onResetFiltersLinkClicked=function(){return t.search.resetFilterFields(),t.search.performSearch(HM.InstrumentationSearchOrigin.FilterBarReset),!1};this.$resetFiltersLink.on("click",this._onResetFiltersLinkClicked);this._onSearchVMPropertyChange=function(n,i){i.path==="Date"||i.path==="DateRange"?t.createDatePickerMenu():i.path==="HasAttachments"?t.createAttachmentMenu():i.path==="Folders"?t.createFolderSelector():i.path==="Categories"&&t.createCategorySelector(),t.updateAreSearchFiltersDefault()},n.observable.simpleOn(this.search,"propertyChange",this._onSearchVMPropertyChange)},onCmdBubble:function(n,t,i){var r=null;t.name==="menu.click"?i.key==="attachment"&&(this.search.hasAttachments(i.attachment),r=HM.InstrumentationSearchOrigin.FilterBarAttachment):t.name==="searchdatepicker.select"?i.key==="dateselected"&&(this.search.date(i.date),this.search.dateRange(i.dateRange),r=HM.InstrumentationSearchOrigin.FilterBarDate):t.name==="cs.select"&&(i.key==="folder"?(this.search.folders(i.selection),r=HM.InstrumentationSearchOrigin.FilterBarFolder):i.key==="category"&&(this.search.categories(i.selection),r=HM.InstrumentationSearchOrigin.FilterBarCategory)),r!==null&&this.search.performSearch(r)},filtersSummaryText:function(n){return ol.Accessor(this,"FiltersSummaryText",n)},updateFiltersSummaryTitle:function(){var r=!this.search.areFoldersDefault(),u=!this.search.areCategoriesDefault(),f=!this.search.areAttachmentsDefault(),e=!this.search.isDateDefault(),t=(r?1:0)+(u?1:0)+(f?1:0)+(e?1:0),i=ol.GetString("SearchFilters.FilterBy"),n;t>1?i=ol.GetString("SearchFilters.FilterByParam").format(ol.GetString("SearchFilters.MultipleFilters").format(t)):t===1&&(n="",r?n=this.getFolderSelectorTitle():u?n=this.getCategorySelectorTitle():f?n=this.getAttachmentTitle():e&&(n=this.getDateMenuTitle()),i=ol.GetString("SearchFilters.FilterByParam").format(n)),this.filtersSummaryText(i)},createFolderSelector:function(){var n=this.getFolderSelectorTitle();this.folderSelector()?this.folderSelector().title(n):this.folderSelector(new t.ContainerSelector({key:"folder",containerList:this.search.folderList(),title:n,isMultiSelect:!0,menuAnchorClass:this.subMenuOptions.menuAnchorClass,titleClass:this.subMenuOptions.titleClass,menuChevClass:this.subMenuOptions.menuChevClass,filterFn:function(n){return n.isSearchable()},clearSelectionItemTemplate:"#containerSelectorClearSelectionItemTemplate",clearSelectionItemText:ol.GetString("AdvancedSearch.Folders.AllFolders")})),this.folderSelector().initialSelection(this.search.folders())},getFolderSelectorTitle:function(){return this.base.getContainerSelectorTitle(this.search.folders(),this.search.folderList(),"Search.Folder","Search.Folders.MultipleFolders")},createCategorySelector:function(){var n=this.getCategorySelectorTitle();this.categorySelector()?this.categorySelector().title(n):this.categorySelector(new t.ContainerSelector({key:"category",containerList:this.search.categoryList(),title:n,isMultiSelect:!0,menuAnchorClass:this.subMenuOptions.menuAnchorClass,titleClass:this.subMenuOptions.titleClass,menuChevClass:this.subMenuOptions.menuChevClass,filterFn:function(n){return n.isSearchable()},clearSelectionItemTemplate:"#containerSelectorClearSelectionItemTemplate",clearSelectionItemText:ol.GetString("AdvancedSearch.Categories.AllCategories")})),this.categorySelector().initialSelection(this.search.categories())},getCategorySelectorTitle:function(){return this.base.getContainerSelectorTitle(this.search.categories(),this.search.categoryList(),"Search.Category","Search.Categories.MultipleCategories")},createDatePickerMenu:function(){this.datePickerMenu()?(this.datePickerMenu().title(this.getDateMenuTitle()),this.datePickerMenu().date(this.search.date()),this.datePickerMenu().dateRange(this.search.dateRange())):this.datePickerMenu(new t.SearchDatePickerMenu({title:this.getDateMenuTitle(),menuAnchorClass:this.subMenuOptions.menuAnchorClass,titleClass:this.subMenuOptions.titleClass,params:this.subMenuOptions.params,loc:this.subMenuOptions.loc,menuChevClass:this.subMenuOptions.menuChevClass,date:this.search.date(),dateRange:this.search.dateRange()}))},getDateMenuTitle:function(){if(this.search.isDateDefault())return ol.GetString("Search.Date");switch(this.search.dateRange()){case HM.SearchDateRange.ExactDate:return this.search.date();case HM.SearchDateRange.AndEarlier:return ol.GetString("Search.DateFilterTitle.AndEarlier").format(this.search.date());case HM.SearchDateRange.AndLater:return ol.GetString("Search.DateFilterTitle.AndLater").format(this.search.date());default:var n=this.base.getDateRangeTitle(this.search.dateRange());return ol.GetString("Search.DateFilterTitle.DateAndRange").format(this.search.date(),n)}},createAttachmentMenu:function(){var r,i,n,u;if(this.attachmentMenu())this.attachmentMenu().title(this.getAttachmentTitle());else{for(r=[],i=this.base.getAttachmentMenuData(),n=0;n<i.length;n++)u=ol.GetString("Search.Attachments."+i[n].text),r.push(new t.MenuItem({text:u,key:"attachment",eventData:{attachment:i[n].value}}));this.attachmentMenu(new t.Menu({title:this.getAttachmentTitle(),menuAnchorClass:this.subMenuOptions.menuAnchorClass,titleClass:this.subMenuOptions.titleClass,params:this.subMenuOptions.params,loc:this.subMenuOptions.loc,menuChevClass:this.subMenuOptions.menuChevClass,items:r}))}},getAttachmentTitle:function(){return this.search.areAttachmentsDefault()?ol.GetString("Search.Attachments")||"":this.base.getAttachmentTitle(this.search.hasAttachments())},updateAreSearchFiltersDefault:function(){this.areSearchFiltersDefault(this.search.areAttachmentsDefault()&&this.search.areCategoriesDefault()&&this.search.areFoldersDefault()&&this.search.isDateDefault())}};r.base=ol.c.searchBaseControl,n.views.tags({searchFiltersControl:r}),ol.markControlAsLoaded("SearchFiltersControl")}(window.originaljQuery||window.jQuery)